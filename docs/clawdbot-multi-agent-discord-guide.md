# Clawdbot å¤š Agent Discord è·¯ç”±é…ç½®æŒ‡å—

> åŸºäºå®æˆ˜è¸©å‘ç»éªŒæ•´ç†ï¼Œé¿å…ä½ èµ°å¼¯è·¯

## æ¦‚è¿°

æœ¬æ•™ç¨‹æ•™ä½ å¦‚ä½•é…ç½®ä¸€ä¸ª**ç§äººä¸“å±** Discord Botï¼Œæ ¹æ®ä¸åŒé¢‘é“è‡ªåŠ¨è·¯ç”±åˆ°ä¸åŒçš„ Agent åç«¯ã€‚

```
Discord Bot (1ä¸ª)
    â”‚
    â”œâ”€â”€ #main é¢‘é“ â”€â”€â†’ main agent
    â”œâ”€â”€ #code é¢‘é“ â”€â”€â†’ coder agent
    â””â”€â”€ #research é¢‘é“ â”€â”€â†’ researcher agent
```

**é€‚ç”¨åœºæ™¯**ï¼š
- æƒ³è®©ç¼–ç¨‹è®¨è®ºå’Œæ—¥å¸¸é—²èŠåˆ†å¼€
- ä¸åŒé¡¹ç›®ç”¨ä¸åŒçš„ agent ä¸Šä¸‹æ–‡
- ä¸ªäººç§æœ‰ AI åŠ©æ‰‹

---

## å¤š Agent çš„ä»·å€¼

åœ¨é…ç½®ä¹‹å‰ï¼Œå…ˆç†è§£**ä¸ºä»€ä¹ˆè¦ç”¨å¤š Agent**ã€‚

### å¤š Agent vs å• Agent

| åœºæ™¯ | å• Agent | å¤š Agent |
|------|----------|----------|
| **ä¸Šä¸‹æ–‡æ±¡æŸ“** | ç¼–ç¨‹å’Œé—²èŠæ··åœ¨ä¸€èµ· | å„è‡ªç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰° |
| **æ–‡ä»¶è®¿é—®** | èƒ½çœ‹æ‰€æœ‰ç›®å½• | å¯ä»¥é™åˆ¶èŒƒå›´ï¼Œæ›´å®‰å…¨ |
| **æˆæœ¬æ§åˆ¶** | éƒ½ç”¨è´µæ¨¡å‹ | ç®€å•ä»»åŠ¡ç”¨ä¾¿å®œæ¨¡å‹ |
| **äººè®¾ä¸“æ³¨** | ä¸‡èƒ½ä½†ä¸ä¸“ | å„æœ‰ä¸“é•¿ï¼Œå›ç­”æ›´ç²¾å‡† |

### Agent ä¹‹é—´çš„å·®å¼‚

æ¯ä¸ª Agent å¯ä»¥æœ‰ç‹¬ç«‹çš„é…ç½®ï¼š

```json
{
  "agents": {
    "list": [
      {
        "id": "main",
        "workspace": "~/clawd",
        "model": { "primary": "anthropic/claude-opus-4-5" }
      },
      {
        "id": "coder",
        "workspace": "~/projects",
        "model": { "primary": "anthropic/claude-sonnet-4" }
      }
    ]
  }
}
```

| å¯é…ç½®é¡¹ | è¯´æ˜ |
|----------|------|
| `workspace` | å·¥ä½œç›®å½•ï¼Œé™åˆ¶ Agent èƒ½è®¿é—®çš„æ–‡ä»¶èŒƒå›´ |
| `model` | ä½¿ç”¨çš„æ¨¡å‹ï¼Œä¸åŒä»»åŠ¡ç”¨ä¸åŒæˆæœ¬çš„æ¨¡å‹ |
| `systemPrompt` | äººè®¾æç¤ºè¯ï¼Œè®© Agent ä¸“æ³¨ç‰¹å®šé¢†åŸŸ |
| ä¼šè¯è®°å¿† | è‡ªåŠ¨éš”ç¦»ï¼Œå„ Agent ç‹¬ç«‹è®°å¿† |

### ä¸æ¶ˆæ¯æ¸ é“æ— å…³

å¤š Agent æ˜¯ Clawdbot çš„æ ¸å¿ƒèƒ½åŠ›ï¼Œ**ä¸æ¶ˆæ¯å…¥å£æ— å…³**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Clawdbot Gateway             â”‚
â”‚                                     â”‚
â”‚   Agent A    Agent B    Agent C     â”‚
â”‚   (é…ç½®A)    (é…ç½®B)    (é…ç½®C)     â”‚
â”‚      â†‘          â†‘          â†‘        â”‚
â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚
â”‚           â”‚  æ¶ˆæ¯è·¯ç”±  â”‚            â”‚
â”‚      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”       â”‚
â”‚      â†“         â†“           â†“       â”‚
â”‚   Discord   WhatsApp     å…¶ä»–      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

æ— è®ºä» Discord è¿˜æ˜¯ WhatsApp è§¦å‘ï¼Œéƒ½èƒ½äº«å—ï¼š
- ä¸Šä¸‹æ–‡éš”ç¦»
- ç‹¬ç«‹é…ç½®
- ä¸åŒæ¨¡å‹
- ä¸“å±äººè®¾

### ä»€ä¹ˆæ—¶å€™éœ€è¦å¤š Agentï¼Ÿ

**éœ€è¦**ï¼š
- ç¼–ç¨‹é—®é¢˜å’Œæ—¥å¸¸é—²èŠæƒ³åˆ†å¼€
- ä¸åŒé¡¹ç›®ç”¨ä¸åŒçš„å·¥ä½œç›®å½•
- æƒ³çœé’±ï¼ˆç®€å•ä»»åŠ¡ç”¨ä¾¿å®œæ¨¡å‹ï¼‰

**ä¸éœ€è¦**ï¼š
- ä¸ªäººè½»åº¦ä½¿ç”¨
- ä¸åœ¨ä¹ä¸Šä¸‹æ–‡æ··åˆ
- æ‡’å¾—ç®¡ç†å¤šä¸ªé…ç½®

> ğŸ’¡ å¦‚æœä¸ç¡®å®šï¼Œå¯ä»¥å…ˆä»å• Agent å¼€å§‹ï¼Œæœ‰éœ€è¦å†æ‹†åˆ†ã€‚

---

## å‰ç½®æ¡ä»¶

- å·²å®‰è£… Clawdbot/Moltbot
- æœ‰ Discord è´¦å·

---

## ç¬¬é›¶æ­¥ï¼šåˆ›å»ºç§æœ‰ Discord æœåŠ¡å™¨

> âš ï¸ **é‡è¦**ï¼šä¸ºäº†é˜²æ­¢ä»–äººå‘ç°ä½ çš„ Botï¼Œå»ºè®®åˆ›å»ºä¸€ä¸ª**ç§æœ‰æœåŠ¡å™¨**ä¸“é—¨ç”¨äº Bot äº¤äº’ã€‚

### åˆ›å»ºæœåŠ¡å™¨

1. åœ¨ Discord å·¦ä¾§ç‚¹å‡» **+** åˆ›å»ºæœåŠ¡å™¨
2. é€‰æ‹© **Create My Own** â†’ **For me and my friends**
3. è¾“å…¥æœåŠ¡å™¨åç§°ï¼ˆå¦‚ "My AI Assistant"ï¼‰

### è®¾ç½®æœåŠ¡å™¨ä¸ºç§æœ‰

ç¡®ä¿æœåŠ¡å™¨ä¸ä¼šè¢«ä»–äººå‘ç°ï¼š

1. å³é”®æœåŠ¡å™¨å›¾æ ‡ â†’ **æœåŠ¡å™¨è®¾ç½®**
2. å·¦ä¾§é€‰æ‹© **ç¤¾åŒº** â†’ ç¡®ä¿**æœªå¯ç”¨**ç¤¾åŒºåŠŸèƒ½
3. å·¦ä¾§é€‰æ‹© **Discovery**ï¼ˆå‘ç°ï¼‰â†’ ç¡®ä¿**æœªå¯ç”¨**æœåŠ¡å™¨å‘ç°
4. å·¦ä¾§é€‰æ‹© **é‚€è¯·** â†’ å¯ä»¥ç¦ç”¨æˆ–é™åˆ¶é‚€è¯·é“¾æ¥

### ç§æœ‰æœåŠ¡å™¨çš„å¥½å¤„

| è®¾ç½® | æ•ˆæœ |
|------|------|
| ä¸å¯ç”¨ç¤¾åŒºåŠŸèƒ½ | æœåŠ¡å™¨ä¸ä¼šå‡ºç°åœ¨ Discord çš„å…¬å¼€åˆ—è¡¨ä¸­ |
| ä¸å¯ç”¨æœåŠ¡å™¨å‘ç° | æ— æ³•é€šè¿‡æœç´¢æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨ |
| ä¸åˆ†äº«é‚€è¯·é“¾æ¥ | åªæœ‰ä½ çŸ¥é“æœåŠ¡å™¨çš„å­˜åœ¨ |

è¿™æ ·å³ä½¿æœ‰äººçŸ¥é“ä½ çš„ Bot å­˜åœ¨ï¼Œä¹Ÿæ— æ³•æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨æ¥å°è¯•ä¸ Bot äº¤äº’ã€‚

---

## æ ¸å¿ƒæ¦‚å¿µï¼šDiscord ID ä½“ç³»

åœ¨é…ç½®ä¹‹å‰ï¼Œå…ˆç†è§£ Discord çš„ ID ä½“ç³»ï¼š

```
Discord
â”œâ”€â”€ æœåŠ¡å™¨ (Guild)          â† Guild IDï¼ˆæœåŠ¡å™¨å”¯ä¸€æ ‡è¯†ï¼‰
â”‚   â”œâ”€â”€ #é¢‘é“1 (Channel)    â† Channel IDï¼ˆé¢‘é“å”¯ä¸€æ ‡è¯†ï¼‰
â”‚   â”œâ”€â”€ #é¢‘é“2 (Channel)    â† Channel ID
â”‚   â””â”€â”€ æˆå‘˜
â”‚       â”œâ”€â”€ ç”¨æˆ·A           â† User IDï¼ˆç”¨æˆ·å…¨å±€å”¯ä¸€æ ‡è¯†ï¼‰
â”‚       â””â”€â”€ ç”¨æˆ·B           â† User ID
â””â”€â”€ Bot                     â† Bot ID / Client IDï¼ˆBot å”¯ä¸€æ ‡è¯†ï¼‰
```

### ID ç±»å‹è¯´æ˜

| ID ç±»å‹ | ä½œç”¨ | ç¤ºä¾‹ | åœ¨å“ªé‡Œè·å– |
|---------|------|------|-----------|
| **Guild ID** | æ ‡è¯†ä¸€ä¸ªæœåŠ¡å™¨ | `1234567890123456789` | å³é”®æœåŠ¡å™¨å›¾æ ‡ â†’ å¤åˆ¶æœåŠ¡å™¨ ID |
| **Channel ID** | æ ‡è¯†ä¸€ä¸ªé¢‘é“ | `1234567890123456790` | å³é”®é¢‘é“åç§° â†’ å¤åˆ¶é¢‘é“ ID |
| **User ID** | æ ‡è¯†ä¸€ä¸ªç”¨æˆ·ï¼ˆå…¨å±€å”¯ä¸€ï¼‰ | `1234567890123456791` | å³é”®ç”¨æˆ·å¤´åƒ â†’ å¤åˆ¶ç”¨æˆ· ID |
| **Bot ID** | æ ‡è¯†ä¸€ä¸ª Botï¼ˆ= Client IDï¼‰ | `1234567890123456792` | Developer Portal â†’ General Information |

### é…ç½®ä¸­å„ ID çš„ç”¨é€”

```json
{
  "guilds": {
    "Guild ID": {           // â† å…è®¸ Bot å“åº”çš„æœåŠ¡å™¨
      "users": ["User ID"]  // â† å…è®¸ä¸ Bot äº¤äº’çš„ç”¨æˆ·
    }
  },
  "bindings": [{
    "guildId": "Guild ID",  // â† è·¯ç”±è§„åˆ™ï¼šå“ªä¸ªæœåŠ¡å™¨
    "peer": { "id": "Channel ID" }  // â† è·¯ç”±è§„åˆ™ï¼šå“ªä¸ªé¢‘é“
  }]
}
```

---

## ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Discord Bot

### 1.1 åˆ›å»ºåº”ç”¨

1. è®¿é—® [Discord Developer Portal](https://discord.com/developers/applications)
2. ç‚¹å‡» **New Application**ï¼Œè¾“å…¥åç§°ï¼ˆå¦‚ "MyAssistant"ï¼‰
3. è®°ä¸‹ **Application ID**ï¼ˆä¹Ÿå« Client IDï¼Œåé¢ç”Ÿæˆé‚€è¯·é“¾æ¥è¦ç”¨ï¼‰

### 1.2 é…ç½® Bot

å·¦ä¾§èœå•é€‰æ‹© **Bot**ï¼š

1. ç‚¹å‡» **Reset Token** è·å– Bot Token
   > âš ï¸ **Token åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œç«‹å³å¤åˆ¶ä¿å­˜åˆ°å®‰å…¨çš„åœ°æ–¹ï¼**

2. **å…³é—­ Public Bot**ï¼ˆé‡è¦ï¼ï¼‰
   ```
   Public Bot: OFF  â† å…³é—­ååªæœ‰ä½ èƒ½é‚€è¯·æ­¤ Bot
   ```

3. å¼€å¯ **Privileged Gateway Intents**ï¼š
   - âœ… **PRESENCE INTENT**ï¼ˆå¯é€‰ï¼Œç”¨äºæ˜¾ç¤ºåœ¨çº¿çŠ¶æ€ï¼‰
   - âœ… **SERVER MEMBERS INTENT**ï¼ˆå¯é€‰ï¼Œç”¨äºè·å–æˆå‘˜ä¿¡æ¯ï¼‰
   - âœ… **MESSAGE CONTENT INTENT**ï¼ˆå¿…é¡»ï¼ç”¨äºè¯»å–æ¶ˆæ¯å†…å®¹ï¼‰

4. ç‚¹å‡»é¡µé¢åº•éƒ¨ **Save Changes**

### 1.3 ç”Ÿæˆé‚€è¯·é“¾æ¥

å·¦ä¾§é€‰æ‹© **OAuth2 â†’ URL Generator**ï¼š

**Scopes**ï¼ˆå‹¾é€‰ï¼‰ï¼š
- âœ… `bot`
- âœ… `applications.commands`ï¼ˆå¯é€‰ï¼Œç”¨äº Slash å‘½ä»¤ï¼‰

**Bot Permissions**ï¼ˆå»ºè®®å…¨é€‰ä»¥ä¸‹æƒé™ï¼‰ï¼š

| æƒé™ | è¯´æ˜ |
|------|------|
| âœ… Administrator | ç®¡ç†å‘˜æƒé™ï¼ˆåŒ…å«æ‰€æœ‰æƒé™ï¼Œæœ€æ–¹ä¾¿ï¼‰ |

æˆ–è€…å¦‚æœä¸æƒ³ç»™ç®¡ç†å‘˜æƒé™ï¼Œè‡³å°‘å‹¾é€‰ï¼š

| æƒé™ | è¯´æ˜ |
|------|------|
| âœ… View Channels | æŸ¥çœ‹é¢‘é“ |
| âœ… Send Messages | å‘é€æ¶ˆæ¯ |
| âœ… Send Messages in Threads | åœ¨å¸–å­ä¸­å‘é€æ¶ˆæ¯ |
| âœ… Embed Links | åµŒå…¥é“¾æ¥ |
| âœ… Attach Files | é™„åŠ æ–‡ä»¶ |
| âœ… Read Message History | è¯»å–æ¶ˆæ¯å†å² |
| âœ… Add Reactions | æ·»åŠ ååº” |
| âœ… Use Slash Commands | ä½¿ç”¨æ–œæ å‘½ä»¤ |
| âœ… Mention Everyone | @æ‰€æœ‰äººï¼ˆå¯é€‰ï¼‰ |
| âœ… Manage Messages | ç®¡ç†æ¶ˆæ¯ï¼ˆå¯é€‰ï¼Œç”¨äºåˆ é™¤æ¶ˆæ¯ï¼‰ |

**ç”Ÿæˆçš„ URL æ ¼å¼**ï¼š
```
https://discord.com/api/oauth2/authorize?client_id=ä½ çš„CLIENT_ID&permissions=8&scope=bot%20applications.commands
```

> `permissions=8` è¡¨ç¤ºç®¡ç†å‘˜æƒé™

### 1.4 é‚€è¯· Bot åˆ°æœåŠ¡å™¨

1. åœ¨æµè§ˆå™¨æ‰“å¼€ç”Ÿæˆçš„ URL
2. é€‰æ‹©ä½ çš„æœåŠ¡å™¨
3. ç‚¹å‡»æˆæƒ

---

## ç¬¬äºŒæ­¥ï¼šè·å– Discord ID

åœ¨ Discord å®¢æˆ·ç«¯å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼š

1. è®¾ç½® â†’ é«˜çº§ â†’ å¼€å¯ **å¼€å‘è€…æ¨¡å¼**

ç„¶åè·å–ä»¥ä¸‹ IDï¼š

| éœ€è¦è·å–çš„ ID | æ“ä½œ |
|--------------|------|
| æœåŠ¡å™¨ ID (Guild ID) | å³é”®æœåŠ¡å™¨å›¾æ ‡ â†’ å¤åˆ¶æœåŠ¡å™¨ ID |
| é¢‘é“ ID (Channel ID) | å³é”®é¢‘é“åç§° â†’ å¤åˆ¶é¢‘é“ ID |
| ä½ çš„ç”¨æˆ· ID (User ID) | å³é”®è‡ªå·±å¤´åƒ â†’ å¤åˆ¶ç”¨æˆ· ID |

---

## ç¬¬ä¸‰æ­¥ï¼šé…ç½® Discord é¢‘é“ï¼ˆå®‰å…¨é…ç½®é‡ç‚¹ï¼ï¼‰

ç¼–è¾‘ `~/.clawdbot/clawdbot.json`ï¼Œåœ¨ `channels` ä¸­æ·»åŠ ï¼š

```json
{
  "channels": {
    "discord": {
      "enabled": true,
      "token": "ä½ çš„Bot Token",
      "groupPolicy": "allowlist",
      "dm": {
        "policy": "allowlist",
        "allowFrom": ["ä½ çš„ç”¨æˆ·ID"]
      },
      "guilds": {
        "ä½ çš„æœåŠ¡å™¨ID": {
          "requireMention": true,
          "users": ["ä½ çš„ç”¨æˆ·ID"]
        }
      }
    }
  }
}
```

### å®‰å…¨é…ç½®è¯¦è§£

#### `groupPolicy: "allowlist"`

åªå…è®¸ç™½åå•ä¸­çš„æœåŠ¡å™¨ä½¿ç”¨ Botã€‚å³ä½¿ Bot è¢«æ‹‰åˆ°å…¶ä»–æœåŠ¡å™¨ï¼Œä¹Ÿä¸ä¼šå“åº”ã€‚

#### `guilds` å¯¹è±¡

```json
"guilds": {
  "æœåŠ¡å™¨ID": {
    "requireMention": true,  // å¿…é¡» @Bot æ‰å“åº”
    "users": ["ç”¨æˆ·ID"]      // åªæœ‰è¿™äº›ç”¨æˆ·çš„æ¶ˆæ¯ä¼šè¢«å¤„ç†
  }
}
```

- **åªé…ç½®ä½ è‡ªå·±çš„æœåŠ¡å™¨ ID**ï¼šå…¶ä»–æœåŠ¡å™¨çš„æ¶ˆæ¯ä¼šè¢«å¿½ç•¥
- **`requireMention: true`**ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰ï¼š
  - è®¾ä¸º `true` åï¼ŒBot **åªä¼šå“åº” @æåŠæ¶ˆæ¯**
  - æ™®é€šæ¶ˆæ¯ï¼ˆä¸å¸¦ @ï¼‰ä¼šè¢«å®Œå…¨å¿½ç•¥
  - è¿™æ˜¯é˜²æ­¢è¯¯è§¦å‘çš„é‡è¦ä¿æŠ¤å±‚
  - å³ä½¿æ˜¯ç™½åå•ç”¨æˆ·ï¼Œä¸ @ ä¹Ÿä¸ä¼šå¾—åˆ°å“åº”
- **`users` æ•°ç»„**ï¼šåªæœ‰åˆ—å‡ºçš„ç”¨æˆ· ID æ‰èƒ½ä¸ Bot äº¤äº’

#### `dm` å¯¹è±¡ï¼ˆç§ä¿¡é…ç½®ï¼‰

```json
"dm": {
  "policy": "allowlist",
  "allowFrom": ["ä½ çš„ç”¨æˆ·ID"]
}
```

åªå…è®¸ç™½åå•ä¸­çš„ç”¨æˆ·å‘ç§ä¿¡ç»™ Botã€‚

### å®‰å…¨é˜²æŠ¤æ€»ç»“

| é˜²æŠ¤å±‚ | é…ç½®é¡¹ | æ•ˆæœ |
|--------|--------|------|
| **æœåŠ¡å™¨éšç§** | ç§æœ‰æœåŠ¡å™¨ + ä¸å¯ç”¨å‘ç° | ä»–äººæ— æ³•æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨ |
| **Bot é‚€è¯·** | Public Bot: OFF | åªæœ‰ä½ èƒ½é‚€è¯· Bot |
| **æœåŠ¡å™¨å±‚** | `groupPolicy: "allowlist"` + `guilds` | åªå“åº”æŒ‡å®šæœåŠ¡å™¨ |
| **ç”¨æˆ·å±‚** | `guilds.*.users` | åªå“åº”æŒ‡å®šç”¨æˆ· |
| **è§¦å‘å±‚** | `requireMention: true` | **åªæœ‰ @Bot æ‰å“åº”**ï¼Œæ™®é€šæ¶ˆæ¯å¿½ç•¥ |
| **ç§ä¿¡å±‚** | `dm.policy: "allowlist"` | åªå…è®¸æŒ‡å®šç”¨æˆ·ç§ä¿¡ |

å³ä½¿æœ‰äººæŠŠ Bot æ‹‰åˆ°åˆ«çš„æœåŠ¡å™¨ï¼ˆå¦‚æœ Public Bot æ²¡å…³ï¼‰ï¼Œç”±äºï¼š
1. è¯¥æœåŠ¡å™¨ä¸åœ¨ `guilds` ç™½åå•ä¸­
2. è¯¥ç”¨æˆ·ä¸åœ¨ `users` ç™½åå•ä¸­

Bot ä¹Ÿ**ä¸ä¼šå“åº”**ä»»ä½•æ¶ˆæ¯ã€‚

---

## ç¬¬å››æ­¥ï¼šæ·»åŠ  Agent

ä½¿ç”¨ CLI æ·»åŠ  agentï¼š

```bash
# æ·»åŠ  coder agent
clawdbot agents add coder \
  --workspace ~/clawd/coder \
  --non-interactive

# æ·»åŠ  researcher agent
clawdbot agents add researcher \
  --workspace ~/clawd/researcher \
  --non-interactive

# éªŒè¯
clawdbot agents list
```

---

## ç¬¬äº”æ­¥ï¼šé…ç½®é¢‘é“ç»‘å®šï¼ˆé‡ç‚¹ï¼ï¼‰

### è¸©å‘ç‚¹ 1ï¼šbindings ä½ç½®

âŒ **é”™è¯¯**ï¼šæ”¾åœ¨ `agents` ä¸‹é¢
```json
{
  "agents": {
    "bindings": [...]  // é”™ï¼ä¼šæŠ¥ Unrecognized key
  }
}
```

âœ… **æ­£ç¡®**ï¼šæ”¾åœ¨é…ç½®æ–‡ä»¶**é¡¶å±‚**
```json
{
  "agents": { ... },
  "channels": { ... },
  "bindings": [...]  // é¡¶å±‚ï¼
}
```

### è¸©å‘ç‚¹ 2ï¼špeer æ ¼å¼

âŒ **é”™è¯¯**ï¼špeer ç”¨å­—ç¬¦ä¸²
```json
{
  "peer": "1466336834400424057"  // é”™ï¼
}
```

âœ… **æ­£ç¡®**ï¼špeer æ˜¯å¯¹è±¡
```json
{
  "peer": { "kind": "channel", "id": "1466336834400424057" }
}
```

### å®Œæ•´çš„ bindings é…ç½®

åœ¨ `~/.clawdbot/clawdbot.json` **é¡¶å±‚**æ·»åŠ ï¼š

```json
{
  "bindings": [
    {
      "agentId": "main",
      "match": {
        "channel": "discord",
        "guildId": "ä½ çš„æœåŠ¡å™¨ID",
        "peer": { "kind": "channel", "id": "mainé¢‘é“ID" }
      }
    },
    {
      "agentId": "coder",
      "match": {
        "channel": "discord",
        "guildId": "ä½ çš„æœåŠ¡å™¨ID",
        "peer": { "kind": "channel", "id": "codeé¢‘é“ID" }
      }
    },
    {
      "agentId": "researcher",
      "match": {
        "channel": "discord",
        "guildId": "ä½ çš„æœåŠ¡å™¨ID",
        "peer": { "kind": "channel", "id": "researché¢‘é“ID" }
      }
    }
  ]
}
```

---

## ç¬¬å…­æ­¥ï¼šå¯åŠ¨å¹¶éªŒè¯

```bash
# éªŒè¯é…ç½®æ— è¯¯
clawdbot agents list --json
# æ¯ä¸ª agent åº”æ˜¾ç¤º "bindings": 1

# å¯åŠ¨ gateway
clawdbot gateway start

# æ£€æŸ¥çŠ¶æ€
clawdbot status
# Discord åº”æ˜¾ç¤º ON / OK
```

---

## ç¬¬ä¸ƒæ­¥ï¼šæµ‹è¯•

åœ¨ Discord ä¸åŒé¢‘é“ **@æœºå™¨äºº** å‘æ¶ˆæ¯ï¼š
- #main é¢‘é“ @Bot â†’ main agent å“åº”
- #code é¢‘é“ @Bot â†’ coder agent å“åº”
- #research é¢‘é“ @Bot â†’ researcher agent å“åº”

> ç”±äºé…ç½®äº† `requireMention: true`ï¼Œç›´æ¥å‘æ¶ˆæ¯ä¸ä¼šè§¦å‘å“åº”ï¼Œå¿…é¡» @Botã€‚

---

## å¸¸è§é—®é¢˜

### Q: é…ç½®æŠ¥é”™ "Unrecognized key"
è¿è¡Œ `clawdbot doctor --fix` è‡ªåŠ¨ç§»é™¤æ— æ•ˆé”®ï¼Œç„¶åæ£€æŸ¥é…ç½®æ ¼å¼ã€‚

### Q: Bot ä¸å“åº”
1. æ£€æŸ¥ `clawdbot status` ä¸­ Discord æ˜¯å¦ä¸º ON/OK
2. ç¡®è®¤ Bot å·²è¢«é‚€è¯·åˆ°æœåŠ¡å™¨
3. ç¡®è®¤ä½ çš„ç”¨æˆ· ID åœ¨ `guilds.æœåŠ¡å™¨ID.users` åˆ—è¡¨ä¸­
4. ç¡®è®¤å¼€å¯äº† MESSAGE CONTENT INTENT
5. å¦‚æœé…ç½®äº† `requireMention: true`ï¼Œç¡®ä¿æ¶ˆæ¯ä¸­ @äº† Bot

### Q: æ‰€æœ‰é¢‘é“éƒ½ç”± main å“åº”
æ£€æŸ¥ bindings ä¸­çš„ `peer.id` æ˜¯å¦ä¸é¢‘é“ ID å®Œå…¨åŒ¹é…ã€‚

### Q: Agent ä¹‹é—´èƒ½å…±äº«è®°å¿†å—ï¼Ÿ
ä¸èƒ½ã€‚æ¯ä¸ª agent æœ‰ç‹¬ç«‹çš„ä¼šè¯å†å²ã€‚ä½†å¦‚æœå·¥ä½œåŒºæœ‰çˆ¶å­å…³ç³»ï¼ˆå¦‚ `~/clawd` åŒ…å« `~/clawd/coder`ï¼‰ï¼Œçˆ¶ agent å¯ä»¥è¯»å–å­ç›®å½•çš„æ–‡ä»¶ã€‚

### Q: åˆ«äººèƒ½æŠŠæˆ‘çš„ Bot æ‹‰åˆ°å…¶ä»–æœåŠ¡å™¨å—ï¼Ÿ
å¦‚æœä½ å…³é—­äº† Public Botï¼ˆå‚è§ç¬¬ä¸€æ­¥ 1.2ï¼‰ï¼Œåªæœ‰ä½ èƒ½é‚€è¯· Botã€‚å³ä½¿æœ‰äººé€šè¿‡å…¶ä»–æ–¹å¼é‚€è¯·äº† Botï¼Œç”±äº `groupPolicy: "allowlist"` å’Œ `guilds` ç™½åå•çš„é™åˆ¶ï¼ŒBot ä¹Ÿä¸ä¼šå“åº”ã€‚

### Q: åˆ«äººåœ¨æˆ‘çš„æœåŠ¡å™¨é‡Œ @Bot ä¼šè¢«å“åº”å—ï¼Ÿ
ä¸ä¼šã€‚åªæœ‰ `guilds.æœåŠ¡å™¨ID.users` åˆ—è¡¨ä¸­çš„ç”¨æˆ·æ‰ä¼šè¢«å“åº”ã€‚

---

## å®Œæ•´é…ç½®ç¤ºä¾‹

<details>
<summary>ç‚¹å‡»å±•å¼€å®Œæ•´ clawdbot.json ç¤ºä¾‹</summary>

```json
{
  "agents": {
    "defaults": {
      "model": {
        "primary": "anthropic/claude-opus-4-5"
      },
      "workspace": "/Users/ä½ çš„ç”¨æˆ·å/clawd"
    },
    "list": [
      { "id": "main" },
      {
        "id": "coder",
        "name": "coder",
        "workspace": "/Users/ä½ çš„ç”¨æˆ·å/clawd/coder",
        "agentDir": "/Users/ä½ çš„ç”¨æˆ·å/.clawdbot/agents/coder/agent"
      },
      {
        "id": "researcher",
        "name": "researcher",
        "workspace": "/Users/ä½ çš„ç”¨æˆ·å/clawd/researcher",
        "agentDir": "/Users/ä½ çš„ç”¨æˆ·å/.clawdbot/agents/researcher/agent"
      }
    ]
  },
  "channels": {
    "discord": {
      "enabled": true,
      "token": "ä½ çš„Bot Token",
      "groupPolicy": "allowlist",
      "dm": {
        "policy": "allowlist",
        "allowFrom": ["ä½ çš„ç”¨æˆ·ID"]
      },
      "guilds": {
        "ä½ çš„æœåŠ¡å™¨ID": {
          "requireMention": true,
          "users": ["ä½ çš„ç”¨æˆ·ID"]
        }
      }
    }
  },
  "plugins": {
    "entries": {
      "discord": { "enabled": true }
    }
  },
  "bindings": [
    {
      "agentId": "main",
      "match": {
        "channel": "discord",
        "guildId": "ä½ çš„æœåŠ¡å™¨ID",
        "peer": { "kind": "channel", "id": "mainé¢‘é“ID" }
      }
    },
    {
      "agentId": "coder",
      "match": {
        "channel": "discord",
        "guildId": "ä½ çš„æœåŠ¡å™¨ID",
        "peer": { "kind": "channel", "id": "codeé¢‘é“ID" }
      }
    },
    {
      "agentId": "researcher",
      "match": {
        "channel": "discord",
        "guildId": "ä½ çš„æœåŠ¡å™¨ID",
        "peer": { "kind": "channel", "id": "researché¢‘é“ID" }
      }
    }
  ]
}
```

</details>

---

## å®‰å…¨æ£€æŸ¥æ¸…å•

é…ç½®å®Œæˆåï¼Œç¡®è®¤ä»¥ä¸‹å®‰å…¨è®¾ç½®ï¼š

### Discord ç«¯è®¾ç½®
- [ ] Discord Developer Portal ä¸­ **Public Bot** å·²å…³é—­
- [ ] æœåŠ¡å™¨**æœªå¯ç”¨**ç¤¾åŒºåŠŸèƒ½ï¼ˆé˜²æ­¢å‡ºç°åœ¨å…¬å¼€åˆ—è¡¨ï¼‰
- [ ] æœåŠ¡å™¨**æœªå¯ç”¨**æœåŠ¡å™¨å‘ç°ï¼ˆé˜²æ­¢è¢«æœç´¢åˆ°ï¼‰
- [ ] æœåŠ¡å™¨é‚€è¯·é“¾æ¥æœªå…¬å¼€åˆ†äº«

### Clawdbot é…ç½®
- [ ] `groupPolicy` è®¾ç½®ä¸º `"allowlist"`
- [ ] `guilds` ä¸­åªåŒ…å«ä½ è‡ªå·±çš„æœåŠ¡å™¨ ID
- [ ] `guilds.*.users` ä¸­åªåŒ…å«ä½ è‡ªå·±çš„ç”¨æˆ· ID
- [ ] `guilds.*.requireMention` è®¾ç½®ä¸º `true`ï¼ˆBot åªå“åº” @æåŠï¼‰
- [ ] `dm.policy` è®¾ç½®ä¸º `"allowlist"`
- [ ] `dm.allowFrom` ä¸­åªåŒ…å«ä½ è‡ªå·±çš„ç”¨æˆ· ID

### å®‰å…¨ä¹ æƒ¯
- [ ] Bot Token æ²¡æœ‰æ³„éœ²ç»™ä»»ä½•äºº
- [ ] é…ç½®æ–‡ä»¶ä¸åœ¨å…¬å¼€çš„ Git ä»“åº“ä¸­

---

## å‚è€ƒé“¾æ¥

- [Moltbot å®˜æ–¹æ–‡æ¡£](https://docs.molt.bot)
- [å¤š Agent è·¯ç”±](https://docs.molt.bot/concepts/multi-agent)
- [Discord é¢‘é“é…ç½®](https://docs.molt.bot/channels/discord)
- [Discord Developer Portal](https://discord.com/developers/applications)

---

*æœ€åæ›´æ–°: 2026-01-30*
